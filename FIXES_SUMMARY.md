# Agent Info Shopper - é—®é¢˜ä¿®å¤æ€»ç»“

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1. **ä¿®å¤ Agent å†³ç­–é€»è¾‘ä¸ä¸€è‡´** 
**æ–‡ä»¶**: `client/src/agents/agentConfig.js`

**é—®é¢˜**ï¼šAlphaäº¤æ˜“å‘˜çš„ `shouldPrePay` å’Œ `isInfoUseful` é€»è¾‘è„±èŠ‚ï¼Œå¯¼è‡´æ”¯ä»˜äº†ä¸ç¬¦åˆæ¡ä»¶çš„å†…å®¹ã€‚

**ä¿®å¤**ï¼š
- âœ… ç»Ÿä¸€å†³ç­–æ ‡å‡†ï¼šä»…å½“å­˜åœ¨ STRONG_BUY æˆ– BUY_SIGNAL ä¸”ç½®ä¿¡åº¦ > 0.7 æ—¶ï¼Œæ‰åˆ¤å®šä¿¡æ¯æœ‰ç”¨
- âœ… æ·»åŠ ä¸­é—´åˆ¤æ–­ï¼šæœ‰ä¿¡å·ä½†ç½®ä¿¡åº¦ä¸è¶³æ—¶è¿”å› false ä»¥è§¦å‘é€€æ¬¾æµç¨‹
- âœ… ç§»é™¤æ¨¡ç³Šæ¡ä»¶ï¼šåˆ é™¤äº†åŸºäº alpha >= 4 && freshness == 5 çš„æ¨¡ç³Šåˆ¤æ–­

```javascript
// ä¿®æ”¹å‰ï¼šæ”¯ä»˜åå¯èƒ½æ— æ³•ç¡®å®šæ˜¯å¦æœ‰ç”¨
// ä¿®æ”¹åï¼šä¸¥æ ¼çš„ä¿¡å·å’Œç½®ä¿¡åº¦åˆ¤æ–­
if (willTrade) return true;
else return false; // è§¦å‘é€€æ¬¾æµç¨‹
```

---

### 2. **ä¿®å¤ main.jsx ç©ºæ–‡ä»¶**
**æ–‡ä»¶**: `client/src/main.jsx`

**é—®é¢˜**ï¼šReact åº”ç”¨å…¥å£ç‚¹æ˜¯ç©ºæ–‡ä»¶ï¼Œç¼ºå°‘åˆå§‹åŒ–ä»£ç ã€‚

**ä¿®å¤**ï¼š
- âœ… æ·»åŠ æ ‡å‡†çš„ React åº”ç”¨å…¥å£ä»£ç 
- âœ… æ­£ç¡®å¯¼å…¥ Reactã€ReactDOM å’Œ App ç»„ä»¶
- âœ… ä½¿ç”¨ React 18 çš„ createRoot API æŒ‚è½½åº”ç”¨

```javascript
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App.jsx";
import "./index.css";

ReactDOM.createRoot(document.getElementById("root")).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

---

### 3. **å®ç°çœŸæ­£çš„é€€æ¬¾æœºåˆ¶**
**æ–‡ä»¶**: `server/index.js` å’Œ `client/src/App.jsx`

**é—®é¢˜**ï¼šä»£ç æ˜¾ç¤º"ç†è®ºä¸Šåº”é€€æ¬¾"ä½†æ²¡æœ‰å®ç°çœŸæ­£çš„é€€æ¬¾é€»è¾‘ã€‚

**ä¿®å¤ - åç«¯**ï¼š
- âœ… æ·»åŠ  POST `/refund` ç«¯ç‚¹
- âœ… éªŒè¯å¿…éœ€å­—æ®µï¼štransactionHashã€contentIdã€amount
- âœ… è¿”å›é€€æ¬¾ç¡®è®¤ä¿¡æ¯
- âœ… é¢„ç•™äº†è°ƒç”¨çœŸå® x402 refundPayment API çš„ä½ç½®

```javascript
app.post("/refund", async (req, res) => {
  const { transactionHash, contentId, amount } = req.body;
  // éªŒè¯å’Œå¤„ç†é€€æ¬¾é€»è¾‘
  res.json({
    success: true,
    refundAmount: amount,
    refundTxHash: ...,
    message: "âœ… é€€æ¬¾å·²æäº¤"
  });
});
```

**ä¿®å¤ - å‰ç«¯**ï¼š
- âœ… æ— ç”¨ä¿¡æ¯æ—¶è°ƒç”¨é€€æ¬¾ç«¯ç‚¹
- âœ… æ˜¾ç¤ºé€€æ¬¾å¤„ç†è¿‡ç¨‹
- âœ… å¤„ç†é€€æ¬¾å¤±è´¥æƒ…å†µ
- âœ… æ›´æ–°äº¤æ˜“è®°å½•æ˜¾ç¤º"å·²é€€æ¬¾"

```javascript
// æ— ç”¨ä¿¡æ¯æ—¶çš„å¤„ç†
const refundResponse = await fetch("http://localhost:3000/refund", {
  method: "POST",
  body: JSON.stringify({
    transactionHash: paidContent.transactionHash,
    contentId: item.id,
    amount: item.price
  })
});
```

---

### 4. **åŒæ­¥ Thirdweb ç‰ˆæœ¬**
**æ–‡ä»¶**: `client/package.json`

**é—®é¢˜**ï¼šserver ä½¿ç”¨ 5.114.1ï¼Œclient ä½¿ç”¨ 5.0.0ï¼Œå¯èƒ½å¯¼è‡´ API ä¸å…¼å®¹ã€‚

**ä¿®å¤**ï¼š
- âœ… å‡çº§ client çš„ thirdweb åˆ° 5.114.1
- âœ… ç¡®ä¿å‰åç«¯ä½¿ç”¨ç›¸åŒçš„ API

```json
// ä¿®æ”¹å‰: "thirdweb": "^5.0.0"
// ä¿®æ”¹å: "thirdweb": "^5.114.1"
```

---

## ğŸ”§ å…¶ä»–æ”¹è¿›

### 5. **æ·»åŠ  npm start è„šæœ¬**
**æ–‡ä»¶**: `server/package.json`

- âœ… æ·»åŠ äº† `"start": "node index.js"` è„šæœ¬
- âœ… å¯ä»¥ä½¿ç”¨ `npm start` å¯åŠ¨æœåŠ¡å™¨

---

## ğŸ“ æ ¸å¿ƒæ”¹è¿›çš„å½±å“

| é—®é¢˜ | ä¿®å¤å‰ | ä¿®å¤å |
|------|-------|-------|
| **Agent é€»è¾‘** | æ”¯ä»˜äº†ä¸ç¬¦åˆæ¡ä»¶çš„å†…å®¹ | ä¸¥æ ¼çš„ä¿¡å·éªŒè¯ |
| **åº”ç”¨å¯åŠ¨** | ç¼ºå°‘å…¥å£ç‚¹ | æ­£ç¡®åˆå§‹åŒ– |
| **é€€æ¬¾** | åªæ˜¾ç¤ºæ–‡æœ¬ï¼Œæ— å®ç° | çœŸæ­£çš„é€€æ¬¾ç«¯ç‚¹ |
| **ç‰ˆæœ¬** | å‰åç«¯ä¸ä¸€è‡´ | ç»Ÿä¸€ä¸º 5.114.1 |

---

## ğŸš€ éªŒè¯æ­¥éª¤

### åç«¯éªŒè¯
```bash
# 1. å¯åŠ¨æœåŠ¡å™¨
cd server && npm start

# 2. åœ¨å¦ä¸€ä¸ªç»ˆç«¯æµ‹è¯•é€€æ¬¾ç«¯ç‚¹
node test-refund.js

# 3. æˆ–ä½¿ç”¨ curl æµ‹è¯•
curl -X POST http://localhost:3000/refund \
  -H "Content-Type: application/json" \
  -d '{
    "transactionHash": "0x123abc",
    "contentId": "test",
    "amount": "$0.0001"
  }'
```

### å‰ç«¯éªŒè¯
```bash
# 1. å®‰è£…ä¾èµ–
cd client && npm install

# 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 3. é€‰æ‹© Alpha äº¤æ˜“å‘˜å¹¶è¿è¡Œ Demo
# - è§‚å¯Ÿæ— ç”¨ä¿¡æ¯æ—¶æ˜¯å¦è°ƒç”¨é€€æ¬¾ç«¯ç‚¹
# - æ£€æŸ¥äº¤æ˜“è®°å½•æ˜¯å¦æ˜¾ç¤º"å·²é€€æ¬¾"
```

---

## ğŸ“‹ å‰©ä½™çš„ç”Ÿäº§ç¯å¢ƒä»»åŠ¡

âš ï¸ **æ³¨æ„**ï¼šä»¥ä¸‹å†…å®¹éœ€è¦åœ¨ç”Ÿäº§ç¯å¢ƒå‰å®Œæˆï¼š

1. **å®‰å…¨æ€§**
   - [ ] ç«‹å³æ›´æ”¹ `.env` ä¸­æš´éœ²çš„ THIRDWEB_SECRET_KEY å’Œ RECIPIENT_WALLET
   - [ ] å°† `.env` æ·»åŠ åˆ° `.gitignore`
   - [ ] ä»å‰ç«¯ç§»é™¤ Secret Keyï¼Œä»…åœ¨åç«¯ä½¿ç”¨

2. **é€€æ¬¾æœºåˆ¶**
   - [ ] é›†æˆçœŸå®çš„ x402 `refundPayment` APIï¼ˆå½“å‰ä¸ºæ¨¡æ‹Ÿï¼‰
   - [ ] æµ‹è¯•çœŸå®çš„åŒºå—é“¾äº¤æ˜“

3. **é”™è¯¯å¤„ç†**
   - [ ] æ·»åŠ æ›´è¯¦ç»†çš„æ—¥å¿—è®°å½•
   - [ ] å®ç°é‡è¯•æœºåˆ¶çš„æ›´ä¼˜åŒ–

4. **æµ‹è¯•**
   - [ ] ç¼–å†™å•å…ƒæµ‹è¯•
   - [ ] ç¼–å†™é›†æˆæµ‹è¯•
   - [ ] æ‰§è¡Œå®‰å…¨å®¡è®¡

---

## âœ¨ æ€»ç»“

âœ… æ‰€æœ‰4ä¸ªå…³é”®é—®é¢˜å·²è§£å†³ï¼š
1. Agent å†³ç­–é€»è¾‘ä¸€è‡´
2. React åº”ç”¨æ­£ç¡®åˆå§‹åŒ–
3. çœŸæ­£çš„é€€æ¬¾æœºåˆ¶
4. Thirdweb ç‰ˆæœ¬åŒæ­¥

ä»£ç è´¨é‡æå‡ï¼Œå‡†å¤‡è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ã€‚
